<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">(function(){
    &#39;use strict&#39;;

<span id='Global-util-WindowScrollEventer'>    /**
</span>     * @class Global.util.WindowScrollEventer
     * This tis a EventDispatcher the event depends on the top position of the element
     * @extend Global.ObservableClass,
     */
    Global.define(&#39;Global.util.WindowScrollEventer&#39;,{

        extend: Global.ObservableClass,

        eventName: {
            jquery: &#39;windowscrolleventer&#39;
        },

        isShown: function(top, bottom){
            return bottom &gt; 0 &amp;&amp; top &lt; document.documentElement.clientHeight;
        },

<span id='Global-util-WindowScrollEventer-property-config'>        /**
</span>         *
         * @property {Object[]} config
         * @property {Object} config.$elm target element.
         * @property {Object} config.name event name
        */
        targets: null,

<span id='Global-util-WindowScrollEventer-method-start'>        /**
</span>         * @method start
         */
        start: function() {
            $(window).on(&#39;scroll.&#39; + this.getEventName().jquery, $.proxy(this._onScroll, this));
        },

<span id='Global-util-WindowScrollEventer-method-_onScroll'>        /**
</span>         * @private
         */
        _onScroll: function () {
            this._judgeTrigger(this.getTargets());
        },

<span id='Global-util-WindowScrollEventer-method-_judgeTrigger'>        /**
</span>         * @private
         */
        _judgeTrigger: function(targets){
            var me = this,
                bound, top, bottom;
            Global.Array.each(targets, function(index, target) {
                bound = target.$elm[0].getBoundingClientRect();
                top = bound.top;
                bottom = bound.bottom;
                if(me.isShown(top, bottom)){
                    me.dispatchEvent(target.name + &#39;show&#39;, {target: target});
                }else{
                    me.dispatchEvent(target.name + &#39;hide&#39;, {target: target});
                }
            });
        },

<span id='Global-util-WindowScrollEventer-method-stop'>        /**
</span>         * @method stop
         */
        stop: function () {
            $(window).off(&#39;scroll.&#39; + this.getEventName().jquery);
        },

<span id='Global-util-WindowScrollEventer-method-add'>        /**
</span>         * @method add
         */
        add: function(targets) {
            var res = this.getTargets().concat(targets);
            this.setTargets(res);
        },

<span id='Global-util-WindowScrollEventer-method-remove'>        /**
</span>         * @method remove
         */
        remove: function(name) {
            var me = this,
                targets = this.getTargets(),
                res = [];
            Global.Array.each(targets, function(index, target){
                if(target.name !== name){
                    res.push(target);
                }
            });
            me.setTargets(res);
        }
    });
})();
</pre>
</body>
</html>
